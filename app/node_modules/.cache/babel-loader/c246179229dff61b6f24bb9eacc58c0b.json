{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chienyoushan/Desktop/33/myapp/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chienyoushan/Desktop/33/myapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import jsSHA from\"jssha\";import qs from\"querystring\";var apiRoot=\"https://ptx.transportdata.tw/MOTC/\";var VERSION=\"v2\";var getAuthorizationHeader=function getAuthorizationHeader(){var AppID=\"e28b58a56e754b039fa7f8e5d5e08d0d\";var AppKey=\"PxDDf1UhKahsFBy2hzOQD312tRk\";var GMTString=new Date().toGMTString();var ShaObj=new jsSHA(\"SHA-1\",\"TEXT\");ShaObj.setHMACKey(AppKey,\"TEXT\");ShaObj.update(\"x-date: \"+GMTString);var HMAC=ShaObj.getHMAC(\"B64\");var Authorization='hmac username=\"'+AppID+'\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"'+HMAC+'\"';return{Authorization:Authorization,\"X-Date\":GMTString};};var requestAPI=function requestAPI(){var path=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var param=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};console.log(\"\".concat(apiRoot).concat(VERSION).concat(path,\"?\").concat(qs.stringify(param)));return fetch(\"\".concat(apiRoot).concat(VERSION).concat(path,\"?\").concat(qs.stringify(param)),{method:\"GET\",headers:getAuthorizationHeader()}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var errorMsg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(response.ok){_context.next=5;break;}_context.next=3;return response.json().then(function(msg){return msg.Message;});case 3:errorMsg=_context.sent;throw errorMsg;case 5:return _context.abrupt(\"return\",response.json());case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).then(function(data){return data;});};export default requestAPI;export var requesScenicSpot=function requesScenicSpot(city,param){//觀光景點\nvar ScenicSpotPath=\"/Tourism/ScenicSpot\";if(!city){return requestAPI(ScenicSpotPath,param);}return requestAPI(\"\".concat(ScenicSpotPath,\"/\").concat(city),param);};export var requesRestaurant=function requesRestaurant(city,param){//餐廳\nvar RestaurantPath=\"/Tourism/Restaurant\";if(!city){return requestAPI(RestaurantPath,param);}return requestAPI(\"\".concat(RestaurantPath,\"/\").concat(city),param);};export var requesActivity=function requesActivity(city,param){//餐廳\nvar ActivityPath=\"/Tourism/Activity\";if(!city){return requestAPI(ActivityPath,param);}return requestAPI(\"\".concat(ActivityPath,\"/\").concat(city),param);};","map":{"version":3,"sources":["/Users/chienyoushan/Desktop/33/myapp/src/controller/apiManager.js"],"names":["jsSHA","qs","apiRoot","VERSION","getAuthorizationHeader","AppID","AppKey","GMTString","Date","toGMTString","ShaObj","setHMACKey","update","HMAC","getHMAC","Authorization","requestAPI","path","param","console","log","stringify","fetch","method","headers","then","response","ok","json","msg","Message","errorMsg","data","requesScenicSpot","city","ScenicSpotPath","requesRestaurant","RestaurantPath","requesActivity","ActivityPath"],"mappings":"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","sourcesContent":["import jsSHA from \"jssha\";\nimport qs from \"querystring\";\n\nconst apiRoot = \"https://ptx.transportdata.tw/MOTC/\";\nconst VERSION = \"v2\";\n\nconst getAuthorizationHeader = () => {\n    let AppID = \"e28b58a56e754b039fa7f8e5d5e08d0d\";\n    let AppKey = \"PxDDf1UhKahsFBy2hzOQD312tRk\";\n    let GMTString = new Date().toGMTString();\n    let ShaObj = new jsSHA(\"SHA-1\", \"TEXT\");\n    ShaObj.setHMACKey(AppKey, \"TEXT\");\n    ShaObj.update(\"x-date: \" + GMTString);\n    let HMAC = ShaObj.getHMAC(\"B64\");\n    let Authorization =\n        'hmac username=\"' +\n        AppID +\n        '\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"' +\n        HMAC +\n        '\"';\n    return { Authorization: Authorization, \"X-Date\": GMTString };\n};\n\n\nconst requestAPI = (path = \"\", param = {}) => {\n    console.log(`${apiRoot}${VERSION}${path}?${qs.stringify(param)}`);\n    return fetch(`${apiRoot}${VERSION}${path}?${qs.stringify(param)}`, {\n      method: \"GET\",\n      headers: getAuthorizationHeader(),\n    })\n      .then(async (response) => {\n        if (!response.ok) {\n          const errorMsg = await response.json().then((msg) => msg.Message);\n          // alert\n          throw errorMsg;\n        }\n        return response.json();\n      })\n      .then((data) => data);\n  };\n\nexport default requestAPI;\n\nexport const requesScenicSpot = (city, param) => { //觀光景點\n    const ScenicSpotPath = \"/Tourism/ScenicSpot\";\n\n    if (!city) {\n        return requestAPI(ScenicSpotPath, param);\n    }\n    return requestAPI(`${ScenicSpotPath}/${city}`, param);\n};\n\nexport const requesRestaurant = (city, param) => { //餐廳\n    const RestaurantPath = \"/Tourism/Restaurant\";\n\n    if (!city) {\n        return requestAPI(RestaurantPath, param);\n    }\n    return requestAPI(`${RestaurantPath}/${city}`, param);\n};\n\nexport const requesActivity = (city, param) => { //餐廳\n    const ActivityPath = \"/Tourism/Activity\";\n\n    if (!city) {\n        return requestAPI(ActivityPath, param);\n    }\n    return requestAPI(`${ActivityPath}/${city}`, param);\n};"]},"metadata":{},"sourceType":"module"}